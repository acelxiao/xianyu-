# é—²é±¼æ•°æ®ç®¡ç†ç³»ç»Ÿ - å®Œæ•´éƒ¨ç½²æ•™ç¨‹

## ğŸ“‹ ç›®å½•
1. [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
2. [å¿«é€Ÿéƒ¨ç½²](#å¿«é€Ÿéƒ¨ç½²)
3. [æ‰‹åŠ¨éƒ¨ç½²](#æ‰‹åŠ¨éƒ¨ç½²)
4. [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
5. [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
7. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
8. [æ›´æ–°ç»´æŠ¤](#æ›´æ–°ç»´æŠ¤)

---

## ğŸ”§ ç³»ç»Ÿè¦æ±‚

### åŸºç¡€ç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10/11ã€macOS 10.14+ã€Ubuntu 18.04+
- **Pythonç‰ˆæœ¬**ï¼šPython 3.8+ ï¼ˆæ¨è3.9+ï¼‰
- **å†…å­˜è¦æ±‚**ï¼šè‡³å°‘ 4GB RAM
- **ç£ç›˜ç©ºé—´**ï¼šè‡³å°‘ 2GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œç¯å¢ƒ**ï¼šéœ€è¦äº’è”ç½‘è¿æ¥

### ä¾èµ–è½¯ä»¶
- Python 3.8+
- pip åŒ…ç®¡ç†å™¨
- Gitï¼ˆå¯é€‰ï¼Œç”¨äºç‰ˆæœ¬æ§åˆ¶ï¼‰

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èï¼‰

### æ–¹æ³•ä¸€ï¼šä¸€é”®éƒ¨ç½²è„šæœ¬
1. **ä¸‹è½½é¡¹ç›®**
   ```bash
   # ä¸‹è½½é¡¹ç›®æ–‡ä»¶åˆ°ç›®æ ‡ç”µè„‘
   # å°†æ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹å¤åˆ¶åˆ°ç›®æ ‡ä½ç½®
   ```

2. **è¿è¡Œéƒ¨ç½²è„šæœ¬**
   ```bash
   # Windowsç”¨æˆ·
   python deploy_start.py

   # æˆ–è€…åŒå‡»è¿è¡Œ deploy_start.py æ–‡ä»¶
   ```

3. **ç­‰å¾…å®Œæˆ**
   - è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆæ‰€æœ‰é…ç½®
   - çœ‹åˆ° "æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ" æç¤ºå³å¯

4. **è®¿é—®ç³»ç»Ÿ**
   - æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://127.0.0.1:5000
   - ç™»å½•é¡µé¢ï¼šhttp://127.0.0.1:5000/login

### æ–¹æ³•äºŒï¼šæ‰¹å¤„ç†æ–‡ä»¶å¯åŠ¨ï¼ˆWindowsï¼‰
1. åŒå‡»è¿è¡Œ `å¯åŠ¨Webç³»ç»Ÿ.bat`
2. ç­‰å¾…ç³»ç»Ÿå¯åŠ¨å®Œæˆ
3. è®¿é—®ï¼šhttp://127.0.0.1:5000

---

## ğŸ› ï¸ æ‰‹åŠ¨éƒ¨ç½²ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python --version
# æˆ–
python3 --version

# å‡çº§pip
python -m pip install --upgrade pip
```

### 2. ä¸‹è½½é¡¹ç›®æ–‡ä»¶
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd xianyu-system

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate
```

### 3. å®‰è£…ä¾èµ–
```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–åŒ…
pip install -r requirements.txt

# å®‰è£…Playwrightæµè§ˆå™¨
playwright install chromium
```

### 4. åˆ›å»ºç›®å½•ç»“æ„
```bash
# åˆ›å»ºå¿…è¦çš„ç›®å½•
mkdir -p instance logs uploads static/uploads
```

### 5. åˆå§‹åŒ–æ•°æ®åº“
```bash
# åˆå§‹åŒ–æ•°æ®åº“å’Œé»˜è®¤è´¦æˆ·
python init_database.py

# æˆ–è€…ç›´æ¥è¿è¡Œweb_app.pyè®©å®ƒè‡ªåŠ¨åˆå§‹åŒ–
```

### 6. å¯åŠ¨åº”ç”¨
```bash
# å¯åŠ¨Webåº”ç”¨
python web_app.py

# æˆ–ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒé…ç½®
python -m flask run --host=0.0.0.0 --port=5000
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### é»˜è®¤è´¦æˆ·
ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹è´¦æˆ·ï¼š

| è´¦æˆ·ç±»å‹ | ç”¨æˆ·å | å¯†ç  | æƒé™ | è¯´æ˜ |
|---------|--------|------|------|------|
| ç®¡ç†å‘˜ | admin | funnyadmin123 | ç®¡ç†å‘˜ | æ‹¥æœ‰æ‰€æœ‰æƒé™ |
| ä½“éªŒè´¦æˆ· | trial | trial123 | ä½“éªŒ | 3å¤©ä½“éªŒæœŸé™ |

### ç«¯å£é…ç½®
- **é»˜è®¤ç«¯å£**ï¼š5000
- **è®¿é—®åœ°å€**ï¼šhttp://127.0.0.1:5000
- **å±€åŸŸç½‘è®¿é—®**ï¼šhttp://[æœ¬æœºIP]:5000

### æ•°æ®åº“é…ç½®
- **æ•°æ®åº“æ–‡ä»¶**ï¼šinstance/xianyu_data.db
- **å¤‡ä»½ä½ç½®**ï¼šå®šæœŸå¤‡ä»½ instance ç›®å½•
- **æ•°æ®è¿ç§»**ï¼šè§[æ›´æ–°ç»´æŠ¤](#æ›´æ–°ç»´æŠ¤)éƒ¨åˆ†

### ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
```bash
# è®¾ç½®Flaskç¯å¢ƒ
export FLASK_ENV=production
export FLASK_DEBUG=False
export SECRET_KEY=your-secret-key
```

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸŸ æ ¸å¿ƒåŠŸèƒ½
- **æ™ºèƒ½çˆ¬å–**ï¼šè‡ªåŠ¨çˆ¬å–é—²é±¼å•†å“æ•°æ®
- **å…³é”®è¯æœç´¢**ï¼šæ”¯æŒå¤šç§å…³é”®è¯å’Œç­›é€‰æ¡ä»¶
- **å®šæ—¶ä»»åŠ¡**ï¼šè‡ªåŠ¨æ‰§è¡Œå®šæ—¶çˆ¬å–ä»»åŠ¡
- **æ•°æ®ç®¡ç†**ï¼šå¢åˆ æ”¹æŸ¥ã€å¯¼å‡ºExcel
- **å¯è§†åŒ–ç»Ÿè®¡**ï¼šå›¾è¡¨å±•ç¤ºæ•°æ®åˆ†æ

### ğŸ¯ çˆ¬å–ç‰¹æ€§
- **å¤šé¡µé¢çˆ¬å–**ï¼šæ”¯æŒ1-10é¡µæ·±åº¦çˆ¬å–
- **æ™ºèƒ½å»¶è¿Ÿ**ï¼šé˜²æ­¢è¢«åçˆ¬è™«æœºåˆ¶æ£€æµ‹
- **æ˜¾ç¤ºæ¨¡å¼**ï¼šæœ‰å¤´/æ— å¤´æ¨¡å¼åˆ‡æ¢
- **Cookieç®¡ç†**ï¼šè‡ªåŠ¨ç®¡ç†ç™»å½•çŠ¶æ€
- **æ•°æ®å»é‡**ï¼šè‡ªåŠ¨è¿‡æ»¤é‡å¤å•†å“

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- **è§’è‰²æƒé™**ï¼šç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ã€ä½“éªŒç”¨æˆ·
- **æ—¶é—´æ§åˆ¶**ï¼šä½“éªŒè´¦æˆ·è‡ªåŠ¨è¿‡æœŸ
- **æš‚åœåŠŸèƒ½**ï¼šä½“éªŒè´¦æˆ·æ—¶é—´å¯æš‚åœ/æ¢å¤
- **å®‰å…¨è®¤è¯**ï¼šå¯†ç åŠ å¯†ã€å®‰å…¨ç™»å½•

### ğŸ”§ ç®¡ç†åŠŸèƒ½
- **ç³»ç»Ÿè®¾ç½®**ï¼šå‚æ•°é…ç½®ã€é€šçŸ¥è®¾ç½®
- **ä»»åŠ¡ç®¡ç†**ï¼šå®šæ—¶ä»»åŠ¡åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
- **æ—¥å¿—æŸ¥çœ‹**ï¼šç³»ç»Ÿæ“ä½œæ—¥å¿—è®°å½•
- **æ•°æ®å¤‡ä»½**ï¼šæ•°æ®åº“å¤‡ä»½æ¢å¤

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¯åŠ¨æ—¶æç¤ºç«¯å£è¢«å ç”¨
**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# WindowsæŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :5000

# ç»“æŸå ç”¨è¿›ç¨‹
taskkill /PID [è¿›ç¨‹ID] /F

# æˆ–ä¿®æ”¹ç«¯å£å·ï¼ˆåœ¨web_app.pyä¸­ï¼‰
```

### Q2: ä¾èµ–å®‰è£…å¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ¸…ç†pipç¼“å­˜
pip cache purge

# ä½¿ç”¨å›½å†…é•œåƒæº
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/

# é€ä¸ªå®‰è£…ä¾èµ–
pip install Flask==3.0.0
pip install playwright==1.55.0
# ... å…¶ä»–ä¾èµ–
```

### Q3: Playwrightæµè§ˆå™¨å®‰è£…å¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ‰‹åŠ¨å®‰è£…æµè§ˆå™¨
playwright install chromium

# æˆ–ä½¿ç”¨ç³»ç»Ÿæµè§ˆå™¨
playwright install --force
```

### Q4: æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# åˆ é™¤ç°æœ‰æ•°æ®åº“é‡æ–°åˆå§‹åŒ–
rm instance/xianyu_data.db
python -c "from web_app import app, db; app.app_context(); db.create_all()"
```

### Q5: ä½“éªŒè´¦æˆ·æ— æ³•ç™»å½•
**å¯èƒ½åŸå› ï¼š**
- ä½“éªŒæœŸé™å·²è¿‡æœŸ
- è´¦æˆ·è¢«ç¦ç”¨
- å¯†ç é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# é‡ç½®ä½“éªŒè´¦æˆ·
python reset_trial_time.py

# æˆ–åˆ›å»ºæ–°çš„ä½“éªŒè´¦æˆ·
python -c "from web_app import User; from datetime import datetime, timedelta; u=User(username='trial2', role='trial'); u.set_password('trial123'); u.trial_expires_at=datetime.now()+timedelta(days=3); print('Created')"
```

### Q6: çˆ¬å–åŠŸèƒ½æ— æ³•ä½¿ç”¨
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ›´æ–°Cookieé…ç½®
3. æ£€æŸ¥åçˆ¬è™«ç­–ç•¥
4. è°ƒæ•´å»¶è¿Ÿæ—¶é—´

---

## ğŸ”§ æ•…éšœæ’é™¤

### æ£€æŸ¥æ¸…å•
1. âœ… Pythonç‰ˆæœ¬ >= 3.8
2. âœ… æ‰€æœ‰ä¾èµ–åŒ…å·²å®‰è£…
3. âœ… æ•°æ®åº“æ–‡ä»¶å­˜åœ¨
4. âœ… ç«¯å£5000æœªè¢«å ç”¨
5. âœ… ç½‘ç»œè¿æ¥æ­£å¸¸
6. âœ… é˜²ç«å¢™è®¾ç½®æ­£ç¡®

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log
```

### æ€§èƒ½ä¼˜åŒ–
```bash
# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
python -c "import tempfile; import shutil; shutil.rmtree(tempfile.gettempdir(), ignore_errors=True)"

# æ¸…ç†ç¼“å­˜
pip cache purge
```

---

## ğŸ”„ æ›´æ–°ç»´æŠ¤

### æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½å®Œæ•´é¡¹ç›®
tar -czf xianyu-backup-$(date +%Y%m%d).tar.gz .

# ä»…å¤‡ä»½æ•°æ®åº“
cp instance/xianyu_data.db backups/xianyu_data_$(date +%Y%m%d).db
```

### ç³»ç»Ÿæ›´æ–°
1. **å¤‡ä»½ç°æœ‰æ•°æ®**
   ```bash
   cp -r instance backups/instance-$(date +%Y%m%d)
   ```

2. **ä¸‹è½½æ–°ç‰ˆæœ¬**
   - æ›¿æ¢é¡¹ç›®æ–‡ä»¶
   - ä¿ç•™ instance ç›®å½•

3. **æ›´æ–°ä¾èµ–**
   ```bash
   pip install -r requirements.txt --upgrade
   ```

4. **é‡å¯æœåŠ¡**
   ```bash
   python web_app.py
   ```

### æ•°æ®è¿ç§»
```bash
# å¯¼å‡ºæ•°æ®
sqlite3 instance/xianyu_data.db ".dump" > backup.sql

# å¯¼å…¥æ•°æ®
sqlite3 instance/xianyu_data.db < backup.sql
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è‡ªåŠ©æ£€æŸ¥å·¥å…·
é¡¹ç›®å†…ç½®å¤šä¸ªæ£€æŸ¥å·¥å…·ï¼š
- `check_database.py` - æ•°æ®åº“æ£€æŸ¥
- `check_all_users.py` - ç”¨æˆ·è´¦æˆ·æ£€æŸ¥
- `change_admin_password.py` - ç®¡ç†å‘˜å¯†ç é‡ç½®

### è”ç³»æ”¯æŒ
å¦‚é‡åˆ°æŠ€æœ¯é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. æ“ä½œç³»ç»Ÿç‰ˆæœ¬
2. Pythonç‰ˆæœ¬
3. é”™è¯¯ä¿¡æ¯æˆªå›¾
4. æ“ä½œæ­¥éª¤æè¿°

---

## ğŸ“„ è®¸å¯è¯

**é‡è¦æç¤ºï¼š**
- æœ¬ç³»ç»Ÿä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨
- è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„
- è¯·éµå®ˆé—²é±¼å¹³å°ä½¿ç”¨æ¡æ¬¾
- ä¸å¾—ç”¨äºå•†ä¸šç”¨é€”

---

**éƒ¨ç½²å®Œæˆåï¼Œæ‚¨å¯ä»¥ï¼š**
- ğŸŸ å¼€å§‹çˆ¬å–é—²é±¼æ•°æ®
- ğŸ“Š æŸ¥çœ‹ç»Ÿè®¡åˆ†ææŠ¥è¡¨
- â° è®¾ç½®å®šæ—¶ä»»åŠ¡
- ğŸ‘¥ ç®¡ç†ç”¨æˆ·è´¦æˆ·
- ğŸ”§ é…ç½®ç³»ç»Ÿå‚æ•°

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰