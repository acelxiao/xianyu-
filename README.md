# 闲鱼数据管理系统

🔍 **功能完整的闲鱼商品数据抓取与管理Web系统**

使用Playwright + 真实Cookie技术，实现真实的闲鱼商品数据爬取，并通过Web界面进行管理和分析。

## ✨ 主要功能

### 🕷️ 数据爬取
- ✅ 使用真实Cookie获取真实闲鱼商品数据
- ✅ Playwright技术，性能稳定，反检测能力强
- ✅ 支持自定义关键词搜索
- ✅ 可配置爬取页数
- ✅ 自动去重，避免重复保存
- ✅ 支持多种数据提取策略

### 🌐 Web管理系统
- ✅ 美观的Bootstrap响应式界面
- ✅ 商品列表展示与分页
- ✅ 高级搜索功能（标题、关键词筛选）
- ✅ 商品详情查看
- ✅ 数据统计分析
- ✅ 一键删除商品记录
- ✅ 原商品链接跳转

### 📊 数据分析
- ✅ 实时统计总商品数量
- ✅ 价格分布分析
- ✅ 关键词分布图表
- ✅ 数据导出功能
- ✅ 可视化数据展示

## 🚀 快速开始

### 方法一：一键启动（推荐）
双击运行 `启动Web系统.bat` 文件，系统将自动：
1. 初始化数据库
2. 启动Web服务
3. 打开浏览器访问 http://127.0.0.1:5000

### 方法二：命令行启动
```bash
cd "C:\Users\Administrator\Desktop\闲鱼"
python web_app.py
```

### 方法三：仅运行爬虫（无Web界面）
```bash
cd "C:\Users\Administrator\Desktop\闲鱼"
python 自动运行抓取器.py
```

## 📁 文件结构

```
闲鱼/
├── web_app.py                 # Web应用主文件
├── 自动运行抓取器.py          # 独立爬虫程序
├── 启动Web系统.bat            # 一键启动脚本
├── 运行抓取器.bat             # 仅爬虫启动脚本
├── xianyu_data.db            # SQLite数据库（自动生成）
├── templates/                # HTML模板文件夹
│   ├── base.html            # 基础模板
│   ├── index.html           # 商品列表页
│   ├── scrape.html          # 数据爬取页
│   ├── product_detail.html  # 商品详情页
│   └── stats.html           # 数据统计页
└── README.md                # 说明文档
```

## 🎯 使用指南

### 1. 启动系统
1. 双击 `启动Web系统.bat`
2. 等待系统启动（首次启动会创建数据库）
3. 浏览器自动打开 http://127.0.0.1:5000

### 2. 爬取数据
1. 访问"数据爬取"页面
2. 输入搜索关键词（如：手机、相机等）
3. 选择爬取页数（建议1-5页）
4. 点击"开始爬取"
5. 等待爬取完成（2-5分钟）

### 3. 查看数据
1. 商品列表：查看所有爬取的商品
2. 搜索功能：按标题或关键词筛选
3. 商品详情：查看完整商品信息
4. 原链接：直接访问闲鱼商品页面

### 4. 数据分析
1. 访问"数据统计"页面
2. 查看总商品数、价格分布等
3. 导出统计数据为CSV格式
4. 查看关键词分布图表

## 🔧 技术架构

### 后端技术
- **Flask** - 轻量级Web框架
- **SQLAlchemy** - ORM数据库操作
- **SQLite** - 轻量级数据库
- **Playwright** - 现代化浏览器自动化

### 前端技术
- **Bootstrap 5** - 响应式UI框架
- **Bootstrap Icons** - 图标库
- **Axios** - HTTP客户端
- **原生JavaScript** - 交互逻辑

### 爬虫技术
- **Playwright** - 浏览器自动化
- **真实Cookie认证** - 确保数据真实性
- **反检测技术** - 模拟真实用户行为
- **移动端模拟** - 提高成功率

## 📋 功能详细说明

### 商品数据字段
- 商品标题、价格、地区
- 卖家信用等级
- 商品链接和ID
- 搜索关键词和时间
- 数据来源标识

### 搜索功能
- 按商品标题模糊搜索
- 按关键词精确筛选
- 支持组合搜索
- 实时结果更新

### 数据管理
- 批量删除功能
- 重复商品检测
- 数据完整性验证
- 原链接有效性检查

## ⚠️ 注意事项

### 爬虫使用
1. **频率控制**：建议每次爬取不超过10页，避免被限制
2. **时间间隔**：两次爬取之间建议间隔5-10分钟
3. **Cookie有效性**：如遇到爬取失败，可能需要更新Cookie
4. **法律合规**：仅用于学习和研究目的，请遵守相关法律法规

### 系统维护
1. **数据库备份**：定期备份 `xianyu_data.db` 文件
2. **日志检查**：关注爬虫运行日志，及时发现问题
3. **性能监控**：大量数据时注意系统性能

## 🛠️ 故障排除

### 常见问题

**Q: 爬取失败，没有获取到数据？**
A: 可能原因：
- Cookie已过期，需要更新
- 网络连接问题
- 闲鱼网站反爬机制更新
- 搜索关键词过于特殊

**Q: Web应用无法启动？**
A: 检查：
- 是否安装了所需依赖：`pip install flask flask-sqlalchemy`
- 端口5000是否被占用
- Python版本是否支持

**Q: 数据库文件损坏？**
A: 解决方案：
- 删除 `xianyu_data.db` 文件
- 重新启动Web系统自动重建数据库

**Q: 爬取速度很慢？**
A: 优化建议：
- 减少爬取页数
- 使用SSD硬盘
- 确保网络连接稳定

## 📈 系统优势

1. **真实数据**：使用真实Cookie，获取真实商品信息
2. **用户友好**：Web界面操作简单，无需编程知识
3. **数据完整**：提取商品所有关键信息
4. **实时更新**：支持持续爬取，数据实时更新
5. **可扩展性**：模块化设计，易于功能扩展
6. **数据安全**：本地数据库，数据私有安全

## 📞 技术支持

如遇到技术问题，请检查：
1. Python环境和依赖包是否正确安装
2. 网络连接是否正常
3. 系统日志中的错误信息

---

**开发者：Claude Code Assistant**
**版本：1.0**
**更新时间：2025年11月**
**技术栈：Python + Flask + Playwright + Bootstrap**